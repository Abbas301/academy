<div class="main ml-2 mr-2">
    <section>
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-8 mt-2">
                    <button class="btn btn-white" (click)="displayData()"><i matTooltip="Filter" class="fa fa-filter icon"></i></button><small class="header"><b>On Boarded Candidates List</b></small>
                </div>
                <div class="col-md-4">
                    <div class="row">
                        <div class="col-md-7">
                            <mat-form-field class="onboardFilter" appearance="standard">
                                <input matInput (keyup)="applyFilter($event)" placeholder="Candidate Name" #input>
                                <mat-icon matSuffix>search</mat-icon>
                            </mat-form-field>
                        </div>
                        <div class="col-md-5">
                            <button *ngIf="(selection.hasValue() || isAllSelected())" type="button" class="btn onboardbtn" data-toggle="modal" data-target="#exampleModal" data-whatever="@getbootstrap">Create Batch</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="add">
                <mat-card class="filter-card" *ngIf="hideMat">
                    <mat-card-title style="font-size: 19px;">
                        Filters
                    </mat-card-title>
                    <mat-card-content>
                        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    Categories
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <!-- <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                <mat-expansion-panel-header class="categories-filter">
                                    <mat-panel-title>
                                        <mat-panel-title>
                                            Degree
                                        </mat-panel-title>
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div *ngFor="let degrees of degree; let i = index; ">
                                    <mat-checkbox (change)="doFilter($event.checked, degrees)">{{degrees}}</mat-checkbox><br>
                                </div>
                            </mat-expansion-panel>

                            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                <mat-expansion-panel-header class="categories-filter">
                                    <mat-panel-title>
                                        Stream
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div *ngFor="let branch of stream">
                                    <mat-checkbox (change)="doFilter($event.checked, branch)">{{branch}}</mat-checkbox>
                                </div>
                            </mat-expansion-panel>

                            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                <mat-expansion-panel-header class="categories-filter">
                                    <mat-panel-title>
                                        Percentage
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div>
                                    <div *ngFor="let persent of Percentage ">
                                        <mat-checkbox (change)="doFilter($event.checked, persent)">{{persent}}</mat-checkbox>
                                    </div>
                                </div>

                            </mat-expansion-panel>

                            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                <mat-expansion-panel-header class="categories-filter">
                                    <mat-panel-title>
                                        YOP
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div>
                                    <div *ngFor="let year of yearPass">
                                        <mat-checkbox (change)="doFilter($event.checked, year)">{{year}}</mat-checkbox>
                                    </div>
                                </div>
                            </mat-expansion-panel> -->

                            <form [formGroup]="filterForm">
                                <!-- <mat-checkbox *ngFor="let degree of degrees" class="example-margin" [checked]="isChecked('degree',degree)" (change)="change(degrees,'degree',degree,$event.checked)">
                                    {{degree}}
                                </mat-checkbox> -->
                                <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header class="categories-filter">
                                        <mat-panel-title>
                                            <mat-panel-title>
                                                Degree
                                            </mat-panel-title>
                                        </mat-panel-title>
                                    </mat-expansion-panel-header>
                                    <div *ngFor="let degree of degrees">
                                        <mat-checkbox [value]="degree" #DegreeFilter [checked]="isChecked('degree',degree)" (change)="dataChange('degree',degreeFilter)">{{degree}}</mat-checkbox><br>
                                    </div>
                                </mat-expansion-panel>

                                <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header class="categories-filter">
                                        <mat-panel-title>
                                            Stream
                                        </mat-panel-title>
                                    </mat-expansion-panel-header>
                                    <div *ngFor="let branch of stream">
                                        <mat-checkbox [value]="branch" #StreamFilter [checked]="isChecked('stream',branch)" (change)="dataChange('stream',streamFilter)">{{branch}}</mat-checkbox>
                                    </div>
                                </mat-expansion-panel>

                                <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header class="categories-filter">
                                        <mat-panel-title>
                                            Percentage
                                        </mat-panel-title>
                                    </mat-expansion-panel-header>
                                    <div>
                                        <div *ngFor="let percent of Percentage ">
                                            <mat-checkbox [value]="percent" #PercentageFilter [checked]="isChecked('degreePercentage',percent)" (change)="dataChange('degreePercentage',percentageFilter)">{{percent}}</mat-checkbox>
                                        </div>
                                    </div>

                                </mat-expansion-panel>

                                <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header class="categories-filter">
                                        <mat-panel-title>
                                            YOP
                                        </mat-panel-title>
                                    </mat-expansion-panel-header>
                                    <div>
                                        <div *ngFor="let year of yearPass">
                                            <mat-checkbox [value]="year" #YearPassFilter [checked]="isChecked('yop',year)" (change)="dataChange('yop',yearPassFilter)">{{year}}</mat-checkbox>
                                        </div>
                                    </div>
                                </mat-expansion-panel>
                                <!-- <mat-form-field>
                                    <mat-label>Filter</mat-label>
                                    <input matInput formControlName="filter" placeholder="Ex. ium" #input>
                                </mat-form-field> -->
                            </form>

                        </mat-expansion-panel>
                    </mat-card-content>
                </mat-card>

            </div>

            <div class="tables mt-1">
                <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 ">

                    <!-- Checkbox Column -->
                    <ng-container matColumnDef="select">
                        <th mat-header-cell *matHeaderCellDef>
                            <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()" [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                            </mat-checkbox>
                        </th>
                        <td mat-cell *matCellDef="let row">
                            <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null" [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)" (change)="selection.isSelected(row)?selectedCandidates(row):remove(row)">
                            </mat-checkbox>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="name">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>Candidate Name</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                    </ng-container>

                    <ng-container matColumnDef="contactNumber">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>Contact Number</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.contactNumber}} </td>
                    </ng-container>

                    <ng-container matColumnDef="emailId">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>Email Id</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.emailId}} </td>
                    </ng-container>

                    <ng-container matColumnDef="degree">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>Degree</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.degree | uppercase}} </td>
                    </ng-container>
                    <ng-container matColumnDef="stream">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>Stream</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.stream | uppercase}} </td>
                    </ng-container>

                    <ng-container matColumnDef="yop">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>YOP</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.yop}} </td>
                    </ng-container>
                    <ng-container matColumnDef="degreePercentage">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>Degree Aggregate %</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.degreePercentage}} </td>
                    </ng-container>

                    <ng-container matColumnDef="jspiderBranch">
                        <th style="font-size: 13px;" mat-header-cell *matHeaderCellDef> <b>Branch</b> </th>
                        <td mat-cell *matCellDef="let element"> {{element.jspiderBranch}} </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selection.toggle(row)">
                    </tr>
                </table>
            </div>
        </div>
    </section>
    <!--  create-batch-- modal -->

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" data-backdrop="static" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" style="font-weight: 600;" id="exampleModalLabel">Create Batch</h2>
                    <button type="button" class="close" #closeModal (click)="resetFormData()" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
                </div>
                <div class="modal-body">
                    <form action="" [formGroup]="batchForm">
                        <div class="first" style="padding: 1%;">

                            <div class="row">
                                <div class="col-3">
                                    <mat-form-field appearance="standard">
                                        <mat-label>Location</mat-label>
                                        <mat-select formControlName="location">
                                            <mat-option *ngFor="let location of locations" [value]="location.value">
                                                {{location.viewValue}}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="this.batchForm.controls.location.errors?.required">This field is required*</mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-3">
                                    <mat-form-field appearance="standard">
                                        <mat-label>Technology</mat-label>
                                        <mat-select formControlName="technology">
                                            <mat-option *ngFor="let technology of technologies" [value]="technology.value">
                                                {{technology.viewValue}}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error>This field is required*</mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-3">
                                    <mat-form-field appearance="standard">
                                        <mat-label>StartDate</mat-label>
                                        <input matInput [matDatepicker]="picker" formControlName="startDate">
                                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                        <mat-datepicker #picker></mat-datepicker>
                                        <mat-error>This field is required*</mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-3">
                                    <div class="row">
                                        <div class="upload">
                                            <input id="myInp" #files type="file" formControlName="tocPath" (change)="uploadTOC($event)">
                                            <span class="myBtn" (click)="files.click()">UploadTOC</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-3">
                                    <mat-form-field appearance="standard">
                                        <mat-label>TY Mentor</mat-label>
                                        <mat-select formControlName="tyMentors">
                                            <mat-option *ngFor="let technology of TrainerData" [value]="technology.trainerName">
                                                {{technology.trainerName}}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error>This field is required*</mat-error>
                                    </mat-form-field>
                                </div>

                                <div class="col-3">
                                    <mat-form-field appearance="standard">
                                        <mat-label>Delivery Manager</mat-label>
                                        <input matInput type="text" placeholder="Delivery Manager" formControlName="deliveryManager">
                                    </mat-form-field>
                                </div>

                                <div class="col-3">
                                    <mat-form-field appearance="standard">
                                        <mat-label>Batch Type</mat-label>
                                        <mat-select formControlName="batchType" [(value)]="selected">
                                            <mat-option value="INTERNAL">INTERNAL</mat-option>
                                        </mat-select>
                                        <mat-error *ngIf="this.batchForm.controls.batchType.errors?.required">This field is required*</mat-error>
                                    </mat-form-field>
                                </div>

                            </div>
                        </div>

                        <div class="p-3 first">
                            <h3 style="font-weight: 600;">Assign Trainers</h3>
                            <div formArrayName="trainers" *ngFor="let item of trainer.controls; let i = index;">
                                <div [formGroupName]="i">
                                    <div class="row">
                                        <div class="col-3">
                                            <mat-form-field appearance="standard">
                                                <mat-label>assignTrainerName</mat-label>
                                                <mat-select formControlName="assignTrainerName" (selectionChange)="onChangeTrainerName($event,batchForm,i)">
                                                    <mat-option *ngFor="let technology of TrainerData" [value]="technology.trainerName">
                                                        {{technology.trainerName}}
                                                    </mat-option>
                                                </mat-select>
                                                <mat-error *ngIf="assignTrainerName.errors?.required">This field is required*</mat-error>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-3">
                                            <mat-form-field appearance="standard">
                                                <mat-label>Technology</mat-label>
                                                <input matInput class="hover" type="text" formControlName="technologies">
                                                <mat-error>This field is required*</mat-error>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-3">
                                            <mat-form-field appearance="standard">
                                                <mat-label>Days</mat-label>
                                                <mat-select formControlName="days">
                                                    <mat-option *ngFor="let day of days" [value]="day.value">
                                                        {{day.viewValue}}
                                                    </mat-option>
                                                </mat-select>
                                                <mat-error>This field is required*</mat-error>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-3 aliq">
                                            <div class="form_field">
                                                <mat-form-field appearance="standard">
                                                    <mat-label>Email Id</mat-label>
                                                    <input matInput class="hover" type="text" formControlName="emailId">
                                                    <mat-error *ngIf="assignTrainerEmailID.errors?.required">This field is required*</mat-error>
                                                    <mat-error *ngIf="assignTrainerEmailID.errors?.pattern">Enter a valid EmailId*</mat-error>
                                                </mat-form-field>
                                            </div>
                                            <div>
                                                <mat-icon *ngIf="trainer.length - 1" class="icon mt-3" (click)="deleteItem(i)">
                                                    delete
                                                </mat-icon>
                                                <mat-icon class="mt-3" *ngIf="i === trainer.length - 1" (click)="addTrainer()">add_circle
                                                </mat-icon>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="reset" class="btn btn-light" #resetButton>reset</button>
                            <button type="submit" class="btn btn-color batch" (click)="addBatch(batchForm)">Create</button>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>
</div>